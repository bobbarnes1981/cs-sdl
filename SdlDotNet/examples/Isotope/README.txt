Copyright (c)  2005  Simon Gillespie
Modifications by David Hudson

